Options -Indexes

# Bloqueia arquivos sensíveis
<FilesMatch "\.(jar|war|properties|yml|xml|log|git|env|sh)$">
    Order allow,deny
    Deny from all
</FilesMatch>

<IfModule mod_rewrite.c>
    RewriteEngine On

    # --- FORÇAR HTTPS (MÉTODO ROBUSTO PARA CPANEL) ---
    # Verifica se não é HTTPS OU se o header de proxy não é https
    RewriteCond %{HTTPS} off [OR]
    RewriteCond %{HTTP:X-Forwarded-Proto} !https
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    # --- ENVIAR HEADERS PARA O JAVA ---
    # Isso é vital para o Spring Boot saber que é seguro
    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Port "443"

    # --- PROXY REVERSO ---
    # Manda para o Java
    RewriteRule ^(.*)$ http://127.0.0.1:9090/$1 [P,L]
</IfModule>